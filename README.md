# Трекер полезных(Атомных) привычек - бэкенд-часть SPA веб-приложения
## Описание
Джеймс Клир написал книгу «Атомные привычки», которая посвящена приобретению новых полезных привычек и искоренению старых плохих привычек.
В книге хороший пример привычки описывается как конкретное действие, которое можно уложить в одно предложение:
я буду [ДЕЙСТВИЕ] в [ВРЕМЯ] в [МЕСТО]
За каждую полезную привычку необходимо себя вознаграждать или сразу после делать приятную привычку.
Но при этом привычка не должна расходовать на выполнение больше 2 минут.
Данное приложение - трекер полезных привычек, реализует данные потребности.
С помощью приложения можно создать пользователей, их привычки, и использовать телеграм бот, для напоминаний о привычках по времени.

## Выполненные работы:
- Настроен CORS.
- Настроена интеграция с Telegram.
- Реализована пагинация (с выводом по 5 привычек на страницу).
- Все необходимые эндпоинты реализованы.
- Реализованы валидаторы:
  - Исключить одновременный выбор связанной привычки и указания вознаграждения.
  - Время выполнения должно быть не больше 120 секунд.
  - В связанные привычки могут попадать только привычки с признаком приятной привычки.
  - У приятной привычки не может быть вознаграждения или связанной привычки.
  - Нельзя выполнять привычку реже, чем 1 раз в 7 дней.
- Описаны права доступа:
  - Каждый пользователь имеет доступ только к своим привычкам по механизму CRUD.
  - Пользователь может видеть список публичных привычек без возможности их как-то редактировать или удалять.
- Настроена отложенная задача через Celery.

- Проект покрыли тестами как минимум на 80%.
- Имеется список зависимостей.

  Результат проверки Flake8 равен 100%, при исключении миграций.
- Эндпоинты:
  - Регистрация пользователя
  - Авторизация пользователя
  - Список привычек текущего пользователя с пагинацией
  - Список публичных привычек
  - Создание привычки
  - Редактирование привычки
  - Удаление привычки
- Документация

## Технологии
- Python
- Django, DRF, Django REST framework
- JWT, DRF-YASG
- PostgreSQL
- Celery, Redis

## Модели
- Приятные привычки
- Полезные привычки
- Пользователь


# Начало работы --------------------------------------------------------------------

## Для начала работы с проектом необходимо:
1. Создать и активировать виртуальное окружение 
2. Установить зависимости из requirements.txt : "pip install -r requirements.txt"
3. Создать базу данных
4. Создать файл .env на основе .env_exmpl с вашими данными почты, базы данных
5. Выполнить миграции: "python manage.py makemigrations, python manage.py migrate"
6. Запустить проект
7. 
## Для работы с телеграм рассылкой необходимо выполнить следующее:
1. Должен быть телеграм бот.
2. Нужно прописать TELEGRAM_API_KEY в файл ".env".
3. В аккаунтах пользователей должен быть указан "юзернейм"/имя телеграм аккаунта.
4. Пользователям нужно написать любое сообщение в телеграм бот, чтобы он мог им отправлять уведомления.

## Рекомендации

- Создать суперпользователя можно командой: 
python manage.py csu

- Создать обычного пользователя можно командой: 
python manage.py cu

- Для запуска redis:
redis-cli

- Для запуска celery:
celery -A CW_7_atomic_habits worker --pool=eventlet --loglevel=info

- Для запуска django-celery-beat:
celery -A CW_7_atomic_habits beat --loglevel=info

- Для тестирования проекта запустить команду:
python3 manage.py test

- Для просмотра покрытия тестов:
- coverage run --source='.' manage.py test
- coverage report

- Для запуска приложения:
python3 manage.py runserver

- Проверка flake8:
flake8 CW_7_atomic_habits 

- Документация проекта: 
http://127.0.0.1:8000/swagger/
http://127.0.0.1:8000/redoc/